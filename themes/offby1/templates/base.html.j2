<!DOCTYPE html>
{% if USE_OPEN_GRAPH is not defined %}
    {% set USE_OPEN_GRAPH = True %}
{% endif %}
<html lang="{% block html_lang %}{{ DEFAULT_LANG }}{% endblock %}"{% if USE_OPEN_GRAPH %} prefix="og: http://ogp.me/ns# fb: https://www.facebook.com/2008/fbml"{% endif %}>
    <head>
        <meta charset="utf-8"/>
        <meta http-equiv="Permissions-Policy" content="interest-cohort=()" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta http-equiv="X-Clacks-Overhead" content="GNU Terry Pratchett" />
        
        <title>{% block title %}{{ SITENAME }}{% endblock %}</title>
        
        {% block meta %}
            <meta name="author" content="{{ AUTHOR }}" />
            <meta name="description" content="{% block description %}{{ DESCRIPTION }}{% endblock %}" />
        {% endblock %}

        {# Favicons #}
        <link href="{{ SITEURL }}/favicon.ico" rel="icon">

        {# Open Graph tags #}
        {% if USE_OPEN_GRAPH %}
            {% block opengraph %}
                <meta property="og:site_name" content="{{ SITENAME }}" />
                <meta property="og:type" content="website"/>
                <meta property="og:title" content="{% block og_title %}{{ SITENAME }}{% endblock %}"/>
                <meta property="og:url" content="{% block og_url %}{{ SITEURL }}{% endblock %}"/>
                <meta property="og:description" content="{% block og_description %}{{ DESCRIPTION }}{% endblock %}"/>
                {% if OPEN_GRAPH_IMAGE %}
                <meta property="og:image" content="{{ SITEURL }}/{{ OPEN_GRAPH_IMAGE }}"/>
                {% endif %}
            {% endblock %}
        {% endif %}

        {# Stylesheet #}
        {% assets filters="scss",
        output="css/offby1-style.css",
        depends=["**/_*.scss", "offby1/**/*.scss", "_var.scss", "_custom_var.scss"],
        "offby1.scss" %}
        <link rel="stylesheet" href="{{ SITEURL }}/{{ ASSET_URL }}" type="text/css" />
        {% endassets %}
        
        {# Magnific Popup CSS #}
        {% assets output="css/magnific-popup.min.css", "magnific-popup/dist/magnific-popup.css" %}
        <link rel="stylesheet" href="{{ SITEURL }}/{{ ASSET_URL }}" type="text/css" />
        {% endassets %}

        {# Feeds #}
        {% if FEED_ATOM %}
            <link href="{{ FEED_DOMAIN }}/{{ FEED_ATOM }}" type="application/atom+xml" rel="alternate" title="{{ SITENAME }} ATOM Feed" />
        {% endif %}
        {% if FEED_RSS %}
            <link href="{{ FEED_DOMAIN }}/{{ FEED_RSS }}" type="application/rss+xml" rel="alternate" title="{{ SITENAME }} RSS Feed" />
        {% endif %}

        {% block extra_head %}{% endblock %}
    </head>
    
    <body class="{% block body_class %}{% endblock %}">
        <header>
            <div class="header-content">
                <a href="{{ SITEURL }}/" class="avatar">
                    <picture>
                        <source srcset="{{ SITEURL }}/theme/images/dark/headshot.png" media="(prefers-color-scheme: dark)">
                        <img src="{{ SITEURL }}/theme/images/light/headshot.png" alt="{{ AUTHOR }}">
                    </picture>
                </a>
                <div class="site-title">
                    <a href="{{ SITEURL }}/" class="title-logo" role="img" aria-label="{{ SITENAME }}"></a>
                    <p class="tagline">{{ DESCRIPTION }}</p>
                </div>
            </div>
        </header>
        
        <nav>
            <ul>
                <li><a href="{{ SITEURL }}/">Home</a></li>
                {% for page_link in LINKS %}
                <li><a href="{{ SITEURL }}{{ page_link.link }}">{{ page_link.name }}</a></li>
                {% endfor %}
                <li><a href="{{ SITEURL }}/tags.html">Tags</a></li>
                <li><a href="{{ SITEURL }}/categories.html">Categories</a></li>
            </ul>
        </nav>

        {% include "missing_adblock.html" %}
        
        <main>
            {% block content %}{% endblock %}
        </main>
        
        <footer>
            <div class="footer-content">
                <div class="footer-links">
                    {% for social in SOCIAL %}
                    <a href="{{ social.link }}" rel="me">{{ social.name }}</a>
                    {% if not loop.last %}<span>·</span>{% endif %}
                    {% endfor %}
                </div>
                <p>© {{ PUBLICATION_TIME.year }} {{ AUTHOR }} · Built with <a href="https://getpelican.com">Pelican</a></p>
            </div>
        </footer>

        {% block scripts %}
        {# jQuery - required for Magnific Popup #}
        {% assets output="js/jquery.min.js", "jquery/dist/jquery.min.js" %}
        <script src="{{ SITEURL }}/{{ ASSET_URL }}"></script>
        {% endassets %}
        
        {# Magnific Popup for image galleries #}
        {% assets output="js/magnific-popup.min.js", "magnific-popup/dist/jquery.magnific-popup.min.js" %}
        <script src="{{ SITEURL }}/{{ ASSET_URL }}"></script>
        {% endassets %}
        <script src="{{ SITEURL }}/theme/js/gallery.js"></script>
        
        {# Littlefoot footnotes - loaded from node_modules via webassets #}
        {% assets output="js/littlefoot.min.js", "littlefoot/dist/littlefoot.js" %}
        <script src="{{ SITEURL }}/{{ ASSET_URL }}"></script>
        {% endassets %}
        <script type="text/javascript">
            littlefoot.littlefoot({
                anchorPattern: /(sf-cv-|sf-|footnote-|note-)\d+/gi,
                anchorParentSelector: 'sup',
                footnoteSelector: 'ol.simple-footnotes li',
                allowMultiple: false,
                buttonTemplate: '<button aria-label="Footnote <% number %>" class="littlefoot__button" id="<% reference %>" title="See Footnote <% number %>"><% number %></button>'
            });
        </script>
        
        {# Ad-blocker detection script #}
        <script src="{{ SITEURL }}/theme/js/adblocker.js"></script>
        {% endblock %}
    </body>
</html>
